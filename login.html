  <!DOCTYPE html>
  <html lang="en">
    <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
      />

      <link rel="stylesheet" href="./css/login.css" />
      <title>Meditation Spot Login</title>
    </head>
    <body>
      <div class="container">
        <input type="checkbox" id="flip" />
        <div class="cover">
          <div class="front">
            <img src="./images/bgForm.jpg" alt="" />
            <div class="text">
              <span class="text-1"
                >Every new friend is a <br />
                new adventure</span
              >
              <span class="text-2">Let's get connected</span>
            </div>
          </div>
          <div class="back">
            <img src="./images/bgForm.jpg" alt="" />
            <div class="text">
              <span class="text-1"
                >Complete miles of journey <br />
                with one step</span
              >
              <span class="text-2">Let's get started</span>
            </div>
          </div>
        </div>

        <!-- Login -->
        <div class="forms">
          <div class="form-content">
            <div class="login-form">
              <div class="title">Login</div>

              <div class="input-boxes">
                <div class="input-box">
                  <i class="fas fa-envelope"></i>
                  <input
                    type="text"
                    placeholder="Enter your email"
                    required
                    id="signInEmail"
                  />
                </div>
                <div class="input-box">
                  <i class="fas fa-lock"></i>
                  <input
                    type="password"
                    placeholder="Enter your password"
                    required
                    id="signInPassword"
                  />
                </div>
                <div class="button input-box">
                  <input type="submit" value="Submit" id="signInSubmit" />
                </div>
                <div class="text sign-up-text">
                  Don't have an account? <label for="flip">Sign up now</label>
                </div>
              </div>
            </div>

            <!-- Signup -->
            <div class="signup-form">
              <div class="title">Signup</div>
              <div class="input-boxes">
                <div class="input-box">
                  <i class="fas fa-user"></i>
                  <input
                    type="text"
                    placeholder="Enter your name"
                    required
                    id="name"
                  />
                </div>
                <div class="input-box">
                  <i class="fas fa-envelope"></i>
                  <input
                    type="text"
                    placeholder="Enter your email"
                    required
                    id="email"
                  />
                </div>
                <div class="input-box">
                  <i class="fas fa-lock"></i>
                  <input
                    type="password"
                    placeholder="Enter your password"
                    required
                    id="password"
                  />
                </div>
                <div class="button input-box">
                  <input type="submit" value="Submit" id="signUpSubmit" />
                </div>
                <div class="text sign-up-text">
                  Already have an account? <label for="flip">Login now</label>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <script src="script.js"></script>

      <!-- Script for firebase -->
      <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
        import {
          getDatabase,
          ref,
          set,
          get,
          child,
          update,
        } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js";
        import {
          getAuth,
          createUserWithEmailAndPassword,
          signInWithEmailAndPassword,
        } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-auth.js";

        const firebaseConfig = {
          apiKey: "AIzaSyBfPil6ttIUSQc8W7YYqrS2PcuLOn8nfQI",
          authDomain: "meditation-spot.firebaseapp.com",
          databaseURL: "https://meditation-spot-default-rtdb.firebaseio.com",
          projectId: "meditation-spot",
          storageBucket: "meditation-spot.appspot.com",
          messagingSenderId: "871660264200",
          appId: "1:871660264200:web:14cffbf14b3eb2f0286abd",
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const auth = getAuth();

        document.getElementById("signUpSubmit").addEventListener("click", (e) => {
          e.preventDefault();
          const email = document.getElementById("email").value;
          const name = document.getElementById("name").value;
          const password = document.getElementById("password").value;

          createUserWithEmailAndPassword(auth, email, password)
            .then((userCredential) => {
              const user = userCredential.user;

              set(ref(db, "users/" + user.uid), {
                email: email,
                name: name,
              });
              alert("Signup Success");
              localStorage.setItem("fullname", JSON.stringify(name));
              localStorage.setItem("user", JSON.stringify(user));
              window.location.href = "index.html";
            })
            .catch((error) => {
              const errorMessage = error.message;
              alert(errorMessage);
            });
        });

        

        
        // Event listener for the login form submission
        document.getElementById("signInSubmit").addEventListener("click", (e) => {
          e.preventDefault();
          const email = document.getElementById("signInEmail").value;
          const password = document.getElementById("signInPassword").value;

          signInWithEmailAndPassword(auth, email, password)
            .then((userCredential) => {
              const user = userCredential.user;
              const dt = new Date();
              update(ref(db, "users/" + user.uid), {
                last_login: dt,
              });
             

              alert("Login Success");
              localStorage.setItem("user", JSON.stringify(user));
              window.location.href = "index.html";
              
            })
            .catch((error) => {
              const errorMessage = error.message;
              alert(errorMessage);
            });
        });
      </script>
    </body>
  </html>
